<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Verify Admin Sections</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 2rem auto;
            padding: 2rem;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 1rem;
        }
        .section {
            background: white;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .success {
            border-left: 4px solid #4CAF50;
        }
        .error {
            border-left: 4px solid #f44336;
        }
        pre {
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 4px;
            overflow-x: auto;
        }
        .status {
            font-size: 1.2rem;
            font-weight: bold;
            margin-top: 2rem;
            padding: 1rem;
            border-radius: 8px;
        }
        .status.good {
            background: #4CAF50;
            color: white;
        }
        .status.bad {
            background: #f44336;
            color: white;
        }
    </style>
</head>
<body>
    <h1>üîç Admin Panel Section Verification</h1>

    <div class="section">
        <h2>Fetching admin.html from server...</h2>
        <p>This will show the ACTUAL content from the server (not cached)</p>
    </div>

    <div id="results"></div>

    <script>
        async function verifyAdminSections() {
            const resultsDiv = document.getElementById('results');

            try {
                // Fetch admin.html with cache-busting
                const response = await fetch('admin.html?nocache=' + Date.now());
                const html = await response.text();

                // Count occurrences of key sections
                const sections = {
                    'Receipt Availability': (html.match(/Receipt Availability/g) || []).length,
                    'Activation Status Modifiers': (html.match(/Activation Status Modifiers/g) || []).length,
                    'Country of Purchase': (html.match(/Country of Purchase/g) || []).length,
                    'Device Type (Sealed Status)': (html.match(/Device Type \(Sealed Status\)/g) || []).length,
                    'Factory Sealed': (html.match(/Factory Sealed/g) || []).length,
                    'New Sealed': (html.match(/New Sealed/g) || []).length
                };

                let output = '<div class="section success">';
                output += '<h2>‚úÖ Server File Contents:</h2>';
                output += '<pre>';
                for (const [section, count] of Object.entries(sections)) {
                    output += `${section}: ${count} occurrence(s)\n`;
                }
                output += '</pre>';
                output += '</div>';

                // Determine if correct
                const hasActivation = sections['Activation Status Modifiers'] > 0;
                const hasDeviceType = sections['Device Type (Sealed Status)'] > 0;
                const hasFactorySealed = sections['Factory Sealed'] > 0;
                const hasNewSealed = sections['New Sealed'] > 0;

                if (hasActivation || hasFactorySealed) {
                    output += '<div class="status bad">';
                    output += '‚ùå DUPLICATE FOUND: The file still contains "Activation Status Modifiers" or "Factory Sealed"';
                    output += '</div>';
                } else if (hasDeviceType && hasNewSealed) {
                    output += '<div class="status good">';
                    output += '‚úÖ CORRECT: Only "Device Type (Sealed Status)" with "New Sealed/New Activated" exists';
                    output += '</div>';
                } else {
                    output += '<div class="status bad">';
                    output += '‚ùå ERROR: Neither section found - something is wrong';
                    output += '</div>';
                }

                // Show instructions
                output += '<div class="section">';
                output += '<h2>üìã What You Should See in Admin Panel:</h2>';
                output += '<ol>';
                output += '<li>‚úÖ Receipt Availability (Has Receipt / No Receipt)</li>';
                output += '<li>‚úÖ Country of Purchase (Local / Export)</li>';
                output += '<li>‚úÖ Device Type (Sealed Status) with "New Sealed" and "New Activated"</li>';
                output += '<li>‚ùå NO "Activation Status Modifiers" section</li>';
                output += '<li>‚ùå NO "Factory Sealed" / "Activated" rows</li>';
                output += '</ol>';
                output += '</div>';

                output += '<div class="section success">';
                output += '<h2>üîÑ If You Still See Duplicate:</h2>';
                output += '<p><strong>Your browser is showing OLD CACHED content.</strong></p>';
                output += '<p><strong>Solution:</strong></p>';
                output += '<ol>';
                output += '<li>Press <code>Ctrl + Shift + Delete</code> (Windows) or <code>Cmd + Shift + Delete</code> (Mac)</li>';
                output += '<li>Select "Cached images and files"</li>';
                output += '<li>Time range: "All time"</li>';
                output += '<li>Click "Clear data"</li>';
                output += '<li><strong>Close and restart your browser completely</strong></li>';
                output += '<li>Open: <a href="http://localhost:8888/admin.html">http://localhost:8888/admin.html</a></li>';
                output += '</ol>';
                output += '</div>';

                resultsDiv.innerHTML = output;

            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="section error">
                        <h2>‚ùå Error</h2>
                        <p>Failed to fetch admin.html: ${error.message}</p>
                        <p>Make sure the server is running: <code>python -m http.server 8888</code></p>
                    </div>
                `;
            }
        }

        // Run verification on load
        verifyAdminSections();
    </script>
</body>
</html>
